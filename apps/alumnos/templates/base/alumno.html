<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %} SED | Alumno {% endblock %}</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Configuración rápida de Tailwind para dark mode (clases 'class')
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: {
                light: "#34D399", //verde esmeralda
                DEFAULT: "#059669", // verde esmeralda oscuro
                dark: "#047857", // verde esmeralda aun más oscuro
                // Puedes añadir más tonos si lo necesitas
              },
            },
             animation: {
                'fade-in': 'fade-in 0.7s cubic-bezier(.4,0,.2,1) both',
                'spin-once': 'spin 0.4s linear',
              },
             keyframes: {
                'fade-in': {
                    'from': { opacity: 0, transform: 'translateY(20px)' },
                    'to': { opacity: 1, transform: 'translateY(0)' },
                },
                 'spin': {
                     'to': { transform: 'rotate(360deg)' },
                 }
            },
          },
        },
      };
    </script>

    <!-- Tipografía -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      /* Opcional: Estilos para el scrollbar en navegadores que lo permiten */
      ::-webkit-scrollbar {
          width: 8px;
      }
      ::-webkit-scrollbar-track {
          background: #e2e8f0; /* gray-200 */
      }
      ::-webkit-scrollbar-thumb {
          background: #94a3b8; /* gray-400 */
          border-radius: 4px;
      }
       ::-webkit-scrollbar-thumb:hover {
          background: #64748b; /* gray-500 */
      }
      .dark ::-webkit-scrollbar-track {
          background: #1f2937; /* gray-800 */
      }
      .dark ::-webkit-scrollbar-thumb {
          background: #475569; /* gray-600 */
      }
       .dark ::-webkit-scrollbar-thumb:hover {
          background: #64748b; /* gray-500 */
      }
    </style>

    <!-- Iconos (usando Heroicons - solo copié los SVG necesarios para reducir dependencias) -->
  </head>

  <body
    class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen flex flex-col md:flex-row transition-colors duration-300"
  >
    <!-- Header móvil -->
    <header
      class="bg-primary p-4 flex items-center justify-between md:hidden shadow-md dark:bg-gray-800"
    >
      <a href="{% url 'alumno:bienvenida_alumnos' usuario_id=usuario_id %}"
         class="font-bold text-xl tracking-wide text-white hover:text-primary-light transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-white rounded"
         aria-label="Ir a inicio">
          SED
      </a>
      <div class="flex items-center space-x-4">
        <!-- Botón modo oscuro -->
        <button
          id="theme-toggle"
          aria-label="Cambiar tema"
          class="focus:outline-none focus:ring-2 focus:ring-white rounded text-white p-1"
        >
          <!-- Icono de sol/luna -->
          <svg
            id="icon-sun"
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 hidden dark:block"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 3v2m0 14v2m9-9h-2M5 12H3m16.364-6.364l-1.414 1.414M6.05 17.95l-1.414 1.414m12.728 0l1.414-1.414M6.05 6.05L4.636 7.464"
            />
          </svg>
          <svg
            id="icon-moon"
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 dark:hidden"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 3C9.243 3 6.727 4.098 4.929 6.071c-.571.57-.063 1.557.693 1.557.317 0 .626-.121.854-.34A7.962 7.962 0 0112 5a8 8 0 010 16c-3.597 0-6.643-2.388-7.595-5.64a.997.997 0 00-1.324-.614C2.126 15.231 2 15.61 2 16a8 8 0 0010 7.746c1.517.17 2.97-.15 4.327-.888A7.962 7.962 0 0112 21a8 8 0 100-16z"
            />
          </svg>
        </button>
        <!-- Botón menú -->
        <button
          id="menu-toggle"
          aria-label="Abrir menú lateral"
          class="text-white p-1 focus:outline-none focus:ring-2 focus:ring-white rounded"
        >
          <!-- Icono hamburguesa -->
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"
            />
          </svg>
        </button>
      </div>
    </header>

    <!-- Overlay móvil para sidebar -->
    <div
      id="overlay"
      class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden transition-opacity duration-300"
      aria-hidden="true"
    ></div>

    <!-- Contenedor principal: Sidebar + Main -->
    <div class="flex flex-1 overflow-hidden">
      <!-- Sidebar -->
      <aside
        id="sidebar"
        class="bg-gradient-to-b from-primary to-primary-dark text-white w-64 p-6 space-y-8 transform -translate-x-full md:translate-x-0 md:static md:block transition-transform duration-300 ease-in-out z-50 md:z-auto h-full fixed md:relative overflow-y-auto shadow-lg"
        aria-label="Menú de navegación principal"
      >
        <div>
          <a href="{% url 'alumno:bienvenida_alumnos' usuario_id=usuario_id %}"
             class="font-bold text-2xl tracking-wide text-white hover:text-primary-light transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-white rounded p-1"
             aria-label="Ir a inicio">
              SED
          </a>
          <p class="text-sm text-white/80 mb-8">
            SISTEMA DE EVALUACIÓN DOCENTE
          </p>

          <!-- Navegación -->
          <nav class="space-y-3 text-base" aria-label="Navegación principal">
            <a
              href="{% url 'alumno:perfil_alumno' usuario_id=usuario_id %}"
              class="flex items-center group p-2 rounded-lg hover:bg-white hover:bg-opacity-10 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white"
            >
              <!-- Icono Home -->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5 mr-3 text-white group-hover:text-primary-light transition-colors duration-200"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 9.75L12 3l9 6.75v9a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18.75v-9z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 22V12h6v10"
                />
              </svg>
              <span class="text-white group-hover:text-primary-light transition-colors duration-200">Perfil</span>
            </a>
            <a
              href="{% url 'alumno:explorar' usuario_id=usuario_id %}"
              class="flex items-center group p-2 rounded-lg hover:bg-white hover:bg-opacity-10 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white"
            >
              <!-- Icono Chart -->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5 mr-3 text-white group-hover:text-primary-light transition-colors duration-200"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M11 11V3m0 8h8m-8 8v-8m0 8h8m-8 0H3"
                />
              </svg>
               <span class="text-white group-hover:text-primary-light transition-colors duration-200">Explorar</span>
            </a>
            <a
              href="{% url 'alumno:evaluar_docente' usuario_id=usuario_id %}"
              class="flex items-center group p-2 rounded-lg hover:bg-white hover:bg-opacity-10 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white"
            >
              <!-- Icono Usuario -->
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5 mr-3 text-white group-hover:text-primary-light transition-colors duration-200"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5.121 17.804A9 9 0 1118.879 6.196 9 9 0 015.121 17.804z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 11a4 4 0 100-8 4 4 0 000 8zM16 17a8 8 0 00-8 0"
                />
              </svg>
              <span class="text-white group-hover:text-primary-light transition-colors duration-200">Evaluar</span>
            </a>
          </nav>
        </div>

        <div class="pt-6 border-t border-white/20 mt-auto"> {# mt-auto empuja al fondo #}
          <a
            href="{% url 'core:logout' %}"
            class="flex items-center justify-center group p-2 rounded-lg hover:bg-red-600 hover:scale-[1.02] transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white"
            aria-label="Cerrar sesión"
          >
            <!-- Icono Salir -->
            <svg
              xmlns="http://www.w3.org/2000/svg"
              class="h-5 w-5 mr-3 text-white group-hover:text-white transition-colors duration-200"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a2 2 0 01-2 2H5a2 2 0 01-2-2V7a2 2 0 012-2h6a2 2 0 012 2v1"
              />
            </svg>
            <span class="text-white group-hover:text-white transition-colors duration-200">Salir</span>
          </a>
        </div>
      </aside>

      <!-- Main content -->
      <main
        class="flex-1 p-6 overflow-y-auto min-h-0 bg-gray-50 dark:bg-gray-800 md:rounded-none rounded-tr-2xl shadow-inner transition-colors duration-300 animate-fade-in"
        id="main-content"
      >
         {# Aquí se renderizarán los mensajes de Django #}
         {% if messages %}
            <div class="mb-6 space-y-3">
                {% for message in messages %}
                <div
                  class="{% if message.tags == 'success' %}bg-green-100 border-green-400 text-green-700{% elif message.tags == 'error' %}bg-red-100 border-red-400 text-red-700{% else %}bg-blue-100 border-blue-400 text-blue-700{% endif %} border-l-4 rounded-r p-4 flex items-center"
                  role="alert"
                >
                  <div class="flex-shrink-0 mr-3">
                    {% if message.tags == 'success' %}
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    {% elif message.tags == 'error' %}
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    {% else %}
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    {% endif %}
                  </div>
                  <span>{{ message }}</span>
                </div>
                {% endfor %}
            </div>
         {% endif %}
        {% block content %}
        <!-- Aquí va tu contenido dinámico -->
        {% endblock %}
      </main>
    </div>

    <!-- Script para interacción -->
    <script>
      // Elementos
      const menuToggle = document.getElementById("menu-toggle");
      const sidebar = document.getElementById("sidebar");
      const overlay = document.getElementById("overlay");
      const themeToggle = document.getElementById("theme-toggle");
      const iconSun = document.getElementById("icon-sun");
      const iconMoon = document.getElementById("icon-moon");
      const htmlEl = document.documentElement;
      const mainContent = document.getElementById('main-content');


      // Funciones menú
      function openMenu() {
        sidebar.classList.remove("-translate-x-full");
        overlay.classList.remove("hidden");
        // Opcional: deshabilita scroll en body cuando menú abierto en móvil
        document.body.style.overflow = 'hidden';
      }

      function closeMenu() {
        sidebar.classList.add("-translate-x-full");
        overlay.classList.add("hidden");
         // Opcional: habilita scroll de nuevo
        document.body.style.overflow = '';
      }

      menuToggle?.addEventListener("click", () => {
        if (sidebar.classList.contains("-translate-x-full")) {
          openMenu();
        } else {
          closeMenu();
        }
      });

      overlay?.addEventListener("click", closeMenu);

      window.addEventListener("resize", () => {
        if (window.innerWidth >= 768) {
          closeMenu(); // Asegura que el menú se cierra en desktop
           document.body.style.overflow = ''; // Asegura scroll habilitado en desktop
        }
      });

      // Función modo oscuro
      function toggleTheme() {
        if (htmlEl.classList.contains("dark")) {
          htmlEl.classList.remove("dark");
          localStorage.setItem("theme", "light");
          iconSun.classList.add("hidden");
          iconMoon.classList.remove("hidden");
        } else {
          htmlEl.classList.add("dark");
          localStorage.setItem("theme", "dark");
          iconMoon.classList.add("hidden");
          iconSun.classList.remove("hidden");
        }
      }

      themeToggle?.addEventListener("click", () => {
        toggleTheme();
         // Agregar animación de giro
        themeToggle.classList.add('animate-spin-once');
        // Eliminar animación después de que termine
        setTimeout(() => {
            themeToggle.classList.remove('animate-spin-once');
        }, 400); // La duración de la animación es 0.4s
      });


      // Al cargar la página, aplicar tema guardado o sistema
      (function initTheme() {
        const savedTheme = localStorage.getItem("theme");
        const prefersDark = window.matchMedia(
          "(prefers-color-scheme: dark)"
        ).matches;

        if (savedTheme === "dark" || (!savedTheme && prefersDark)) {
          htmlEl.classList.add("dark");
          iconMoon.classList.add("hidden");
          iconSun.classList.remove("hidden");
        } else {
          htmlEl.classList.remove("dark");
          iconSun.classList.add("hidden");
          iconMoon.classList.remove("hidden");
        }
      })();

       // Opcional: Reiniciar animación del main content en navegaciones SPA (si usas htms/alpinejs, etc.)
       // Si es una aplicación tradicional Django, no es necesario
       /*
       document.addEventListener('DOMContentLoaded', () => {
            if(mainContent) {
                 mainContent.classList.remove('animate-fade-in');
                 void mainContent.offsetWidth; // Reinicia la animación
                 mainContent.classList.add('animate-fade-in');
            }
       });
       */

    </script>
  </body>
</html>
